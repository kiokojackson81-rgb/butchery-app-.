/* Smooth scrolling for in-page anchors; reduced-motion users are respected above */
html { scroll-behavior: smooth; -webkit-text-size-adjust: 100%; }

/* Tailwind core layers (using @import to satisfy CSS validator) */
@import "tailwindcss/base";
@import "tailwindcss/components";
@import "tailwindcss/utilities";

/* Optional: a tiny baseline so things don’t look naked before you style */
:root {
  color-scheme: light dark;
  /* Height of the mobile sticky action bar (used by .sticky-safe) */
  --sticky-bar-h: 72px;
}
html, body {
  min-height: 100%;
}
body {
  margin: 0;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Respect Reduced Motion preferences */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
    scroll-behavior: auto !important;
  }
}

@layer components {
  /* Tight page padding on phones; unchanged spacing on desktop */
  .mobile-container {
    max-width: 80rem; /* max-w-7xl */
    margin-left: auto; /* mx-auto */
    margin-right: auto;
    padding-left: 0.75rem; /* px-3 */
    padding-right: 0.75rem;
  }
  @media (min-width: 640px) {
    .mobile-container {
      padding-left: 1.5rem; /* sm:px-6 */
      padding-right: 1.5rem;
    }
  }

  /* Buttons: full-width on phones, auto on desktop; 44px target for thumbs */
  .btn-mobile {
    width: 100%;
    min-height: 44px;
  }
  @media (min-width: 640px) {
    .btn-mobile {
      width: auto;
    }
  }

  /* Inputs: full-width + text size ≥16px to avoid iOS zoom */
  .input-mobile {
    width: 100%;
    font-size: 16px;
  }
  @media (min-width: 640px) {
    .input-mobile {
      font-size: 1rem; /* base font size in Tailwind is 1rem (16px) */
    }
  }

  /* Horizontally scrollable containers (tabs, chip rows, filters) */
  .mobile-scroll-x {
    overflow-x: auto;
    white-space: nowrap;
    -webkit-overflow-scrolling: touch;
  }

  /* Make wide tables scroll horizontally on phones (keep desktop unchanged) */
  .table-wrap {
    overflow-x: auto;
    width: 100%;
  }
  /* Momentum scroll on iOS for large tables */
  .table-wrap { -webkit-overflow-scrolling: touch; }


  /* Subtle edge-fade hint on mobile to indicate scrollable content */
  @media (max-width: 639px) {
    .mobile-scroll-x,
    .table-wrap {
      /* Create a soft fade on both left/right edges without changing layout */
      -webkit-mask-image: linear-gradient(to right, rgba(0,0,0,0) 0, #000 16px, #000 calc(100% - 16px), rgba(0,0,0,0) 100%);
              mask-image: linear-gradient(to right, rgba(0,0,0,0) 0, #000 16px, #000 calc(100% - 16px), rgba(0,0,0,0) 100%);
    }
    /* Opt-out helper when the fade isn’t desired */
    .no-edge-fade {
      -webkit-mask-image: none !important;
              mask-image: none !important;
    }
    /* Tame horizontal overscroll bounce on touch devices */
    .mobile-scroll-x { overscroll-behavior-x: contain; }
  }

  /* Optional: sticky action bar for key actions on phones */
  .sticky-save-bottom {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(8px);
    color: #fff;
    padding: 0.75rem;
    /* Old iOS (pre-13) uses constant(); newer uses env() */
    padding-bottom: calc(0.75rem + constant(safe-area-inset-bottom, 0px));
    padding-bottom: calc(0.75rem + env(safe-area-inset-bottom, 0px));
    z-index: 40;
  }
  @media (min-width: 640px) {
    .sticky-save-bottom {
      position: static;
    }
  }
  .sticky-safe {
    /* Old iOS (pre-13) uses constant(); newer uses env() */
    padding-bottom: calc(var(--sticky-bar-h) + constant(safe-area-inset-bottom, 0px));
    padding-bottom: calc(var(--sticky-bar-h) + env(safe-area-inset-bottom, 0px)); /* sticky bar height + safe-area */
  }
  @media (min-width: 640px) {
    .sticky-safe {
      padding-bottom: 0; /* sm:pb-0 */
    }
  }
  /* add to <main> so sticky bar doesn’t cover content */

  /* Ensure in-page anchors account for sticky bar height on mobile */
  :root {
    scroll-padding-top: var(--sticky-bar-h);
  }

  /* Safe top padding utility (e.g., if we add a top-fixed bar on mobile) */
  .sticky-safe-top { padding-top: env(safe-area-inset-top, 0px); }

  /* On mobile, allow table cells to wrap to reduce sideways scroll pressure */
  @media (max-width: 639px) {
    .table-wrap table {
      table-layout: fixed; /* predictable widths */
      word-wrap: break-word;
      overflow-wrap: anywhere;
    }
    .table-wrap th,
    .table-wrap td {
      white-space: normal; /* permit wrapping */
    }
  }

  /* Subtle, platform-consistent scrollbars for horizontal areas */
  .mobile-scroll-x,
  .table-wrap { scrollbar-width: thin; scrollbar-color: rgba(0,0,0,0.3) transparent; }
  .mobile-scroll-x::-webkit-scrollbar,
  .table-wrap::-webkit-scrollbar { height: 8px; }
  .mobile-scroll-x::-webkit-scrollbar-thumb,
  .table-wrap::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.3); border-radius: 9999px; }
  .mobile-scroll-x::-webkit-scrollbar-track,
  .table-wrap::-webkit-scrollbar-track { background: transparent; }

  /* Accessible utility: visually hidden but still readable by screen readers */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  /* Sticky table header helper (apply to thead for mobile long lists) */
  .thead-sticky th { position: sticky; top: 0; background: inherit; z-index: 1; }

  /* Highlighted text selection for better contrast */
  ::selection { background: rgba(0,0,0,0.12); }

  /* Basic modal scrim + panel helpers */
  .modal-scrim { position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(2px); }
  .modal-panel { background: white; border-radius: 0.75rem; max-height: 90vh; overflow: auto; }

  /* Mobile defaults: prevent iOS zoom by ensuring inputs are ≥16px font-size */
  @media (max-width: 639px) {
    input, select, textarea { font-size: 16px; }
  }

  /* Make headings wrap nicely on narrow screens */
  h1, h2, h3 { text-wrap: balance; }

  /* Ensure images don’t overflow their containers */
  img { max-width: 100%; height: auto; }

  /* Helper to disable page scroll (e.g., when showing modals) */
  .no-scroll { overflow: hidden; }
}

/* Nicer taps on mobile */
* { -webkit-tap-highlight-color: transparent; }

/* Printer-friendly defaults for reports/downloads */
@media print {
  /* Remove sticky bar from print */
  .sticky-save-bottom { display: none !important; }
  /* Use white background and black text */
  body { background: #fff; color: #000; }
  /* Avoid truncation in tables */
  .table-wrap { overflow: visible !important; }
}
